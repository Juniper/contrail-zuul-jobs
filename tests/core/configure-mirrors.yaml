- name: Test the configure-mirrors role
  hosts: all
  roles:
    - role: install-pip-virtualenv
      when: ansible_os_family == 'RedHat'
    - role: configure-mirrors
      mirror_fqdn: "{{ zuul_site_mirror_fqdn|default(omit) }}"
      pypi_mirror: "http://svl-artifactory.juniper.net/artifactory/api/pypi/contrail-pypi-virtual/simple"
      wheel_mirror: "http://svl-artifactory.juniper.net/artifactory/api/pypi/contrail-pypi-virtual"
  post_tasks:
    - name: Install apt package to sanity check the mirror configuration
      package:
        name: "emacs"
        state: "present"
      become: yes
    - name: Install python package to sanity check pypi mirroring
      pip:
        name: "ipaddress"
        state: "present"
      become: yes
