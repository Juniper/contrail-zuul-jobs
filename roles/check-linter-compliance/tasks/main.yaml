---

- name: find files to lint
  hosts: all
  find:
    path: '{{ zuul.project.src_dir }}/roles/'
  register: files_to_lint

- name: Sample project iteration
  debug:
    msg: "Project {{ item.name }} is at {{ item.src_dir }}"
  with_items: {{ zuul.projects.values() | list }}

- name: debug purposes
  debug: '{{ zuul.project.src_dir }}'


- name: lint all files in the project/Ignore upcoming errors to check
  command: 'ansible-lint -r {{ ansible_env.HOME }}/ansible-lint-rules {{ files_to_lint }}'
  ignore_errors: yes

