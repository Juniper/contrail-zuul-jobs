---
- name: Check if the docs source dir is created on executor
  stat:
    path: "{{ docs_dir }}"
  register: docs_dir
  delegate_to: localhost

- name: Upload doc to docs server
  when: docs_dir.stat.exists and docs_dir.stat.readable
  synchronize:
    src: "{{ docs_dir }}"
    dest: "{{ zuul_doc_url }}/{{ zuul_docserver_root }}/"
    mode: push
  no_log: false
