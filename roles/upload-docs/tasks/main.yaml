---
- name: Check if the docs source dir is created on executor
  stat:
    path: "{{ zuul.executor.work_root }}/{{ root_files }}"
  register: docs_dir
  delegate_to: localhost

- name: Upload doc to docs server
  when: docs_dir.stat.exists == True and docs_dir.stat.readable == True
  synchronize:
    src: "{{ zuul.executor.work_root }}/{{ root_files }}"
    dest: "{{ zuul_doc_url }}/{{ zuul_docserver_root }}"
    mode: push
    archive: no
  no_log: false
