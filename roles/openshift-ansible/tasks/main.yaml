---

# SELINUX is already enforced on nodepool nodes

- name: 'install OpenShift Container Platform utilities'
  package:
    name: '{{ item }}'
    state: 'present'
  with_items:
    - 'atomic-openshift-excluder'
    - 'atomic-openshift-utils'
    - 'python-netaddr'
  become: true
  become_user: 'root'
  register: 'packages_installed'

- name: 'remove atomic-openshift packages from the list for the duration of the installation'
  command: 'atomic-openshift-excluder exclude -y'
  become: true
  become_user: 'root'
  vars:
    query: "results[?item=='atomic-openshift-excluder'].changed"
  when: packages_installed | json_query(query) | first | bool

- fail:
    msg: 'just fail'
