#jinja2: trim_blocks:False
provider_config:
  bms:
    ntpserver: 192.168.1.1
    ssh_user: root
    ssh_private_key: /root/.ssh/id_rsa
    domainsuffix: novalocal

instances:
  {%- for host in groups['all'] -%}
  {% set host_roles = {} -%}
  {% if host in groups['control-plane'] -%}
  {% set _dummy = host_roles.update(control_plane_common_roles) -%}
  {% set control_plane_orchestrator_specific_roles = control_plane_specific_roles[cloud_orchestrator] -%}
  {% set _dummy = host_roles.update(control_plane_orchestrator_specific_roles) -%}
  {% endif -%}
  {% if host in groups['data-plane'] -%}
  {% set _dummy = host_roles.update(data_plane_common_roles) -%}
  {% set data_plane_orchestrator_specific_roles = data_plane_specific_roles[cloud_orchestrator] -%}
  {% set _dummy = host_roles.update(data_plane_orchestrator_specific_roles) -%}
  {% endif -%}
  {% if host_roles | length > 0 %}
  {{ hostvars[host].inventory_hostname }}:
    provider: bms
    ip: '{{ hostvars[host].ansible_default_ipv4.address }}'
    roles:
      {{ host_roles | to_nice_yaml | indent(6) -}}
  {% endif -%}
  {%- endfor -%}


global_configuration:
  CONTAINER_REGISTRY: "{{ contrail_docker_registry }}"
  REGISTRY_PRIVATE_INSECURE: True

{% include cloud_orchestrator + '_config.yaml.j2' %}

deployment:
    orchestrator: {{ cloud_orchestrator }}

test_configuration:
    image_web_server: 10.84.5.120
    use_project_scoped_token: True
