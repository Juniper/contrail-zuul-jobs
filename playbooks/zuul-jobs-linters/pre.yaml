- hosts: localhost
  connection: local
  vars:
    src_dir_json_query: "[?short_name=='contrail-zuul-jobs'].src_dir"
    contrail_zuul_jobs_path: '{{ zuul.projects | json_query(src_dir_json_query) | first }}'
    ansible_lint_rules_path: '{{ "{}/{}/ansible-lint-rules/".format("..", contrail_zuul_jobs_path) }}'
  tasks:

    - name: Debug
      debug:
        var: playbook_dir

    - name: Test
      set_fact:
        ansible_lint_rules_path: "/cos/tu/jest/nie/tak/"

    - name: Debug
      debug:
        var: ansible_lint_rules_path

    - name: create ansible-lint config
      copy:
        content: |
          'rulesdir:'
          '  - {{ ansible_lint_rules_path }}'
          'use_default_rules: true'
        dest: '{{ playbook_dir }}/../../.ansible-lint'
        mode: 0644

     - name: Test2
       slurp:
         src: '{{ playbook_dir }}/../../.ansible-lint'
       register: slurp

     - name: Debug
       debug:
         var: slurp

     - name: Debug
       debug:
         var: slurp.content | b64decode
