---
- hosts: all
  roles:
    - role: fetch-docs
      srce_path: '{{ zuul.projects | selectattr("short_name", "equalto", "contrail-infra-doc") | map(attribute="src_dir") | list | first }}/build/html'
      dstn_path: "{{ zuul.executor.work_root }}/build/html"

- hosts: builder
  gather_facts: False
  pre_tasks:
    - name: Create src_dir
      file:
        path: "upload"
        state: directory

  roles:
    - role: upload-docs
      zuul_doc_url: "upload"
      zuul_docserver_root: "var/www/static/infra-doc/"
      root_files: "{{ zuul.executor.work_root }}/build/html"
