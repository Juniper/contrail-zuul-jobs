- job:
    name: contrail-infra-base-integration
    description: |
      Runs roles that are included by default in any of our "base"
      roles to prevent total CI meltdown.
    parent: base-minimal
    required-projects:
      - Juniper/contrail-project-config
    roles:
      - zuul: Juniper/zuul-jobs
    run: tests/base.yaml
    files:
      - ^roles/acquire-ip-address/.*
      - ^roles/contrail-helm-deployer/.*
      - ^tests/.*

- job:
    name: contrail-infra-base-integration-centos-7
    parent: contrail-infra-base-integration
    nodeset: centos-7

- job:
    name: contrail-infra-base-integration-ubuntu-xenial
    parent: contrail-infra-base-integration
    nodeset: ubuntu-xenial

- job:
    name: contrail-vnc-build-package-el-base
    parent: contrail-vnc-base
    description: |
      Job that tests Contrail VNC (controller, analytics, etc.) packaging

      This is a base job for testing packaging of Contrail VNC for Enterprise
      Linux based distributions (CentOS, RHEL). Release-based variants of this
      job are then added to the Juniper/contrail-packages project.
    run: playbooks/packaging/contrail-vnc-el
    post-run: playbooks/packaging/post-vnc-el
    irrelevant-files:
      - specs/.*
    secrets:
      - site_pulp

- job:
    name: contrail-vnc-build-package-centos74
    parent: contrail-vnc-build-package-el-base
    irrelevant-files:
      - specs/.*
    nodeset:
      nodes:
        - name: builder
          label: centos-7-4-builder

